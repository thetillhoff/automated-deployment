# Add specified repository into sources list.
- apt_repository:
    repo: deb http://archive.canonical.com/ubuntu hardy partner
    state: present

# Add specified repository into sources list using specified filename.
- apt_repository:
    repo: deb http://dl.google.com/linux/chrome/deb/ stable main
    state: present
    filename: google-chrome

# Add source repository into sources list.
- apt_repository:
    repo: deb-src http://archive.canonical.com/ubuntu hardy partner
    state: present

# Remove specified repository from sources list.
- apt_repository:
    repo: deb http://archive.canonical.com/ubuntu hardy partner
    state: absent

# Add nginx stable repository from PPA and install its signing key.
# On Ubuntu target:
- apt_repository:
    repo: ppa:nginx/stable

# On Debian target
- apt_repository:
    repo: 'ppa:nginx/stable'
    codename: trusty

---

vars:
  whitelist:
    - vim
    - unzip
tasks:
  - name: Get package facts
    package_facts:
      manager: apt
  - name: Install all packages in whitelist
    apt:
      name: "{{ whitelist }}"
      state: latest
  - name: Remove all packages not in whitelist
    apt:
      name: "{{ ansible_facts.packages | difference(whitelist)}}"
      state: absent

---
